<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur d'improvisation</title>
    <style>
        /* Styles (inchangés, simplifiés pour lisibilité) */
        body {
            margin: 0;
            font-family: Helvetica, Arial, sans-serif;
            background-image: url('https://i.postimg.cc/2yG5hbLL/Conference.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #333333;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        .header, .footer {
            background-color: #1E3B6F;
            color: white;
            text-align: center;
            padding: 15px;
            width: 100%;
            position: fixed;
            z-index: 10;
        }
        .footer {
            bottom: 0;
        }
        button, a {
            background-color: #1E3B6F;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            text-decoration: none;
            transition: background-color 0.3s;
        }
        button:hover, a:hover {
            background-color: #2F4A7E;
        }
        video {
            width: 100%;
            max-width: 500px;
            margin: 20px auto;
            border: 3px solid #1E3B6F;
            border-radius: 6px;
        }
        .container {
            margin-top: 80px;
            width: 90%;
            max-width: 600px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Titre -->
    <div class="header">
        Letmotiv | Simulateur d'improvisation en public
    </div>

    <!-- Contenu principal -->
    <div class="container">
        <button id="generate-subject-btn">Générateur de sujets d'improvisation</button>
        <div id="subject-display" style="margin-top: 10px; font-weight: bold;"></div>
        <video id="preview" autoplay muted></video>
        <div>
            <button id="start-btn">Démarrer l'improvisation</button>
            <button id="stop-btn" disabled>Arrêter l'improvisation</button>
        </div>
        <p id="status">Appuyez sur "Démarrer l'improvisation" pour commencer.</p>
        <video id="playback" controls style="display: none;"></video>
        <a id="download-link" style="display: none;">Télécharger la vidéo de votre prestation</a>
        <div class="evaluation-box" id="evaluation-box">
            <h3>Questions d'auto-évaluation :</h3>
            <p>1. Que penses-tu de la clarté de ton discours ?</p>
            <textarea placeholder="Votre réponse ici..."></textarea>
            <p>2. As-tu fait une introduction et une conclusion ? Est-ce qu'elles sont satisfaisantes selon toi ?</p>
            <textarea placeholder="Votre réponse ici..."></textarea>
            <p>3. Comment évalues-tu ton langage corporel ?</p>
            <textarea placeholder="Votre réponse ici..."></textarea>
            <p>4. Quels points positifs retires-tu de cette improvisation ?</p>
            <textarea placeholder="Votre réponse ici..."></textarea>
            <p>5. Quels axes d'amélioration prioriser ?</p>
            <textarea placeholder="Votre réponse ici..."></textarea>
            <button id="download-answers-btn">Télécharger les réponses</button>
        </div>
    </div>

    <!-- Pied de page -->
    <div class="footer">
        <a href="https://www.letmotiv.fr/offres-particulier/coaching-prise-de-parole" target="_blank">Réservez un coaching sur Letmotiv</a>
    </div>

    <!-- Scripts -->
    <script>
        // Liste des sujets
        const subjects = [
            "Faire un toast : célébrer un voyage autour du monde",
            "Un pitch improvisé : vendre un parapluie au Sahara",
            "Tu es Marylin Monroe après avoir chanté Happy Birthday au Président",
            "Convaincre un jury que le chocolat devrait être gratuit pour tout le monde",
            "Présenter votre candidature pour devenir président de la planète Mars"
        ];

        // Générateur de sujets
        document.getElementById('generate-subject-btn').addEventListener('click', () => {
            const randomSubject = subjects[Math.floor(Math.random() * subjects.length)];
            document.getElementById('subject-display').textContent = randomSubject;
        });

        // Fonctionnalité vidéo (simplifiée ici pour cohérence)
        const startBtn = document.getElementById('start-btn');
        const stopBtn = document.getElementById('stop-btn');
        const playback = document.getElementById('playback');
        const evaluationBox = document.getElementById('evaluation-box');
        let mediaRecorder, recordedChunks = [];

        async function setupCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                document.getElementById('preview').srcObject = stream;
                return stream;
            } catch (err) {
                alert("Accès à la webcam refusé ou indisponible.");
                return null;
            }
        }

        startBtn.addEventListener('click', async () => {
            const stream = await setupCamera();
            if (!stream) return;
            mediaRecorder = new MediaRecorder(stream);
            recordedChunks = [];
            mediaRecorder.ondataavailable = event => recordedChunks.push(event.data);
            mediaRecorder.onstop = () => {
                const blob = new Blob(recordedChunks, { type: 'video/webm' });
                const url = URL.createObjectURL(blob);
                playback.src = url;
                playback.style.display = 'block';
                evaluationBox.style.display = 'block';
            };
            mediaRecorder.start();
            startBtn.disabled = true;
            stopBtn.disabled = false;
        });

        stopBtn.addEventListener('click', () => {
            if (mediaRecorder && mediaRecorder.state === 'recording') {
                mediaRecorder.stop();
                startBtn.disabled = false;
                stopBtn.disabled = true;
            }
        });

        // Télécharger les réponses
        document.getElementById('download-answers-btn').addEventListener('click', () => {
            const questions = [
                "1. Que penses-tu de la clarté de ton discours ?",
                "2. As-tu fait une introduction et une conclusion ? Est-ce qu'elles sont satisfaisantes selon toi ?",
                "3. Comment évalues-tu ton langage corporel ?",
                "4. Quels points positifs retires-tu de cette improvisation ?",
                "5. Quels axes d'amélioration prioriser ?"
            ];
            const answers = Array.from(document.querySelectorAll('.evaluation-box textarea')).map(
                (textarea, index) => `${questions[index]}\nRéponse : ${textarea.value || "Non renseignée"}`
            );
            const content = answers.join('\n\n');
            const blob = new Blob([content], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'evaluation_reponses.txt';
            link.click();
        });
    </script>
</body>
</html>
